#!/usr/bin/bash

 # Set up the layers
rpm-ostree override remove firefox firefox-langpacks

rpm-ostree install -y \
  distrobox \
  light \
  mako \
  playerctl \
  python3-i3ipc \
  snapper \
  sway \
  swayidle \
  waybar \
  wireguard-tools \
  wlsunset \
  wl-clipboard \
  wofi

# Start some services
sudo sed -i 's/#AutomaticUpdatePolicy.*/AutomaticUpdatePolicy=stage/' /etc/rpm-ostreed.conf
sudo systemctl enable rpm-ostreed-automatic.timer
sudo systemctl enable rpm-ostree-countme.timer

# Flatpaks
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flathubrepo
flatpak remote-modify --enable flathub
flatpak remote-delete fedora

flatpak install flathub \
  com.github.tchx84.Flatseal \
  com.google.Chrome \
  com.sublimemerge.App \
  im.riot.Riot \
  org.gimp.GIMP \
  org.gtk.Gtk3theme.Adwaita-dark \
  org.mozilla.firefox \
  org.pulseaudio.pavucontrol

sudo flatpak override --socket=wayland --env=MOZ_ENABLE_WAYLAND=1 --env=MOZ_WEBRENDER=1 --env=MOZ_ACCELERATED=1 org.mozilla.firefox

# Set sway in GDM
sudo mkdir -p /usr/local/share/wayland-sessions/
sudo cp $HOME/.config/sway/sway.desktop /usr/local/share/wayland-sessions/

